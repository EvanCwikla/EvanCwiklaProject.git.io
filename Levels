import pygame
from entities import Player, Enemy
from hazards import MovingBlock
from puzzles import Switch

class Level:
    def __init__(self, data):
        self.player = Player(*data["player"])
        self.enemies = [Enemy(p) for p in data.get("enemies", [])]
        self.blocks = [MovingBlock(p) for p in data.get("blocks", [])]
        self.switches = [Switch(x, y) for (x, y) in data.get("switches", [])]

    def handle_event(self, event):
        pass  # later for SPACE key, restart, etc.

    def update(self):
        keys = pygame.key.get_pressed()
        self.player.handle_input(keys)
        for e in self.enemies: e.update()
        for b in self.blocks: b.update()

    def draw(self, screen):
        self.player.draw(screen)
        for e in self.enemies: e.draw(screen)
        for b in self.blocks: b.draw(screen)
        for s in self.switches: s.draw(screen)
